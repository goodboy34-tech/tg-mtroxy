# –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –ª–æ–≥–æ–≤ (—Ç–µ–∫—É—â–µ–µ)

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ:

#### 1. –£–ª—É—á—à–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ /stats –≤ –±–æ—Ç–µ
- **–ñ–∏–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –∫–Ω–æ–ø–∫–∞ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å" –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: 
  - –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã –¥–ª—è CPU, RAM –∏ –∑–∞–≥—Ä—É–∑–∫–∏ MTProto
  - –≠–º–æ–¥–∑–∏-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞ (üü¢ online / üî¥ offline)
  - –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (uptime) –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–¥—ã
- **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –Ω–æ–¥–∞–º**:
  - MTProto: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
  - SOCKS5: –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  - –°–∏—Å—Ç–µ–º–∞: CPU, RAM, Disk —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
  - –°–µ—Ç—å: –≤—Ö–æ–¥—è—â–∏–π/–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
- **–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**:
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–¥ (online/offline)
  - –°—É–º–º–∞—Ä–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (MTProto + SOCKS5)
  - –°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞ (CPU/RAM)
  - –û–±—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –≤ GB
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–¥—ã —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã

–§–∞–π–ª: `control-panel/src/bot.ts` (lines 1009-1120)

#### 2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ª–æ–≥–æ–≤ –¥–æ 30 –ú–ë

**–ë–æ—Ç (control-panel):**
- –§–∞–π–ª: `control-panel/docker-compose.yml`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
  ```yaml
  logging:
    driver: "json-file"
    options:
      max-size: "10m"  # –ú–∞–∫—Å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
      max-file: "3"     # –ú–∞–∫—Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ (–∏—Ç–æ–≥–æ 30MB)
  ```

**–ù–æ–¥—ã (node-agent):**
- –§–∞–π–ª: `install-node.sh`
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –æ–±–∞ docker-compose —à–∞–±–ª–æ–Ω–∞ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è node-agent –∏ socks5 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
  ```yaml
  logging:
    driver: "json-file"
    options:
      max-size: "10m"
      max-file: "3"
  ```

#### 3. –§—É–Ω–∫—Ü–∏–∏-–ø–æ–º–æ—â–Ω–∏–∫–∏
- `generateProgressBar(percent, length)` - —Å–æ–∑–¥–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã (‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë)
- `showStats(ctx, isEdit)` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:

#### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å –±–æ—Ç–æ–º (control-panel):
```bash
cd /root/mtproxy/control-panel
git pull
docker compose down
docker compose up -d --build
```

#### –ù–∞ –Ω–æ–¥–∞—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –¥–ª—è –Ω–æ–≤—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫):
- –ù–æ–≤—ã–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —É–∂–µ –±—É–¥—É—Ç –∏–º–µ—Ç—å –ª–∏–º–∏—Ç—ã –ª–æ–≥–æ–≤
- –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–æ–¥ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å docker-compose.yml –≤—Ä—É—á–Ω—É—é

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–æ–¥:
```bash
cd /root/mtproxy-node
# –î–æ–±–∞–≤—å—Ç–µ –≤ docker-compose.yml —Å–µ–∫—Ü–∏—é logging –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
# logging:
#   driver: "json-file"
#   options:
#     max-size: "10m"
#     max-file: "3"

docker compose down
docker compose up -d
```

### üéØ –ß—Ç–æ –¥–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–õ—É—á—à–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** - —Å—Ä–∞–∑—É –≤–∏–¥–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö –Ω–æ–¥
2. **–≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞** - –ª–æ–≥–∏ –Ω–µ –±—É–¥—É—Ç —Ä–∞–∑–¥—É–≤–∞—Ç—å—Å—è
3. **–ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –≤–∏–¥–Ω–æ –∫–∞–∫–∏–µ –Ω–æ–¥—ã offline –∏ –ø–æ—á–µ–º—É
4. **–£–¥–æ–±—Å—Ç–≤–æ** - –∫–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã

### üìä –ü—Ä–∏–º–µ—Ä –Ω–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:

```
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∫—Å–∏
‚è∞ 20.01.2025, 15:30

üü¢ Node-Moscow 5–¥
   üî∑ MTProto: 45/100 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë
   üîµ SOCKS5: 12 –∞–∫—Ç–∏–≤–Ω—ã—Ö
   üíª CPU: 23.5% ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë
   üß† RAM: 45.2% ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë
   üíæ Disk: 15%
   üåê ‚Üì1.2MB ‚Üë3.4MB

üü¢ Node-London 12–¥
   üî∑ MTProto: 78/100 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë
   üíª CPU: 45.1% ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë
   üß† RAM: 62.0% ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë
   üíæ Disk: 22%
   üåê ‚Üì2.5MB ‚Üë5.1MB

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìà –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

üñ• –ù–æ–¥: 2 online / 0 offline –∏–∑ 2
üë• –í—Å–µ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:
   ‚Ä¢ MTProto: 123/200
   ‚Ä¢ SOCKS5: 12
üìä –°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞:
   ‚Ä¢ CPU: 34.3%
   ‚Ä¢ RAM: 53.6%
üåê –°—É–º–º–∞—Ä–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫:
   ‚Ä¢ ‚Üì 15.23 GB
   ‚Ä¢ ‚Üë 42.17 GB
```

### üîÑ –î–µ–π—Å—Ç–≤–∏—è –∫–Ω–æ–ø–æ–∫:
- **üîÑ –û–±–Ω–æ–≤–∏—Ç—å** - –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã
- **‚¨ÖÔ∏è –ù–∞–∑–∞–¥** - –≤–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

---

## –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### AD_TAG –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–ó–ê–í–ï–†–®–ï–ù–û)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ `ad_tag` –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ API endpoint `/mtproto/config` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ TAG –±–µ–∑ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

### SOCKS5 —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (–ó–ê–í–ï–†–®–ï–ù–û)
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ GOST v3 —Å JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ Volume sharing —á–µ—Ä–µ–∑ --volumes-from

### –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–ó–ê–í–ï–†–®–ï–ù–û)
- ‚úÖ –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ fallback –º–µ—Ç–æ–¥—ã
- ‚úÖ –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
