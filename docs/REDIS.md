# Redis для кэширования

## Зачем нужен Redis?

Redis помогает повысить производительность системы за счёт кэширования:
- **Данные Remnawave** — кэширование результатов запросов к backend API
- **Данные пользователей** — кэширование информации о пользователях
- **Статистика нод** — кэширование метрик для быстрого доступа

## Использование

### Вариант 1: In-Memory Cache (по умолчанию)

По умолчанию используется простой in-memory cache (`control-panel/src/cache.ts`). Это достаточно для большинства случаев:
- ✅ Не требует дополнительных зависимостей
- ✅ Быстро работает
- ❌ Данные теряются при перезапуске
- ❌ Не подходит для нескольких инстансов

### Вариант 2: Redis (для продакшена)

Для продакшена с высокой нагрузкой рекомендуется использовать Redis:

```bash
# 1. Включите Redis в docker-compose
docker compose --profile redis up -d

# 2. Или установите USE_REDIS=true в .env и уберите profiles из redis service
```

**Преимущества Redis:**
- ✅ Данные сохраняются при перезапуске
- ✅ Подходит для нескольких инстансов (shared cache)
- ✅ Персистентность (AOF)
- ✅ Автоматическая очистка старых данных (LRU)

**Когда использовать Redis:**
- Более 1000 активных пользователей
- Несколько инстансов Control Panel
- Высокая нагрузка на backend API
- Требуется персистентность кэша

## Настройка

В `.env`:
```bash
USE_REDIS=true
REDIS_HOST=redis
REDIS_PORT=6379
```

В `docker-compose.yml` Redis уже настроен, но запускается только с профилем `redis`:
```bash
docker compose --profile redis up -d
```

Или уберите `profiles` из redis service для автоматического запуска.

